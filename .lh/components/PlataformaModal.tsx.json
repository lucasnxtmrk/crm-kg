{
    "sourceFile": "components/PlataformaModal.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 11,
            "patches": [
                {
                    "date": 1746909703122,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1746909764560,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -154,9 +154,10 @@\n           <div className=\"flex justify-end gap-2 pt-2\">\r\n             {plataformaAtual && (\r\n   <div className=\"flex justify-start\">\r\n     <Button\r\n-      variant=\"destructive\"\r\n+      variant=\"default\"\r\n+      style={{backgroundColor:\"#870D0E\"}}\r\n       className=\"flex gap-1 items-center\"\r\n       onClick={async () => {\r\n         const confirmar = confirm('Tem certeza que deseja excluir esta plataforma?');\r\n         if (!confirmar) return;\r\n"
                },
                {
                    "date": 1746909824042,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -173,9 +173,9 @@\n           alert('Erro ao excluir plataforma.');\r\n         }\r\n       }}\r\n     >\r\n-      üóëÔ∏è\r\n+      <Trash2 className=\"h-4 w-4\" />\r\n     </Button>\r\n   </div>\r\n )}\r\n             <Button variant=\"ghost\" onClick={onClose}>\r\n"
                },
                {
                    "date": 1746909831812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -9,9 +9,9 @@\n } from '@/components/ui/dialog';\r\n import { Button } from '@/components/ui/button';\r\n import { Input } from '@/components/ui/input';\r\n import { Label } from '@/components/ui/label';\r\n-import { Pencil } from 'lucide-react';\r\n+import { Pencil, Trash2 } from 'lucide-react';\r\n import Image from 'next/image';\r\n \r\n interface PlataformaModalProps {\r\n   open: boolean;\r\n"
                },
                {
                    "date": 1746909861142,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -150,9 +150,9 @@\n     />\r\n   </div>\r\n </div>\r\n           {/* Bot√µes */}\r\n-          <div className=\"flex justify-end gap-2 pt-2\">\r\n+          <div className=\"flex justify-between gap-2 pt-2\">\r\n             {plataformaAtual && (\r\n   <div className=\"flex justify-start\">\r\n     <Button\r\n       variant=\"default\"\r\n"
                },
                {
                    "date": 1746909893878,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -177,14 +177,17 @@\n       <Trash2 className=\"h-4 w-4\" />\r\n     </Button>\r\n   </div>\r\n )}\r\n-            <Button variant=\"ghost\" onClick={onClose}>\r\n+<div className='flex justify-end gap-2'>\r\n+  <Button variant=\"ghost\" onClick={onClose}>\r\n               Cancelar\r\n             </Button>\r\n             <Button onClick={handleSubmit}>\r\n               {plataformaAtual ? 'Salvar Altera√ß√µes' : 'Cadastrar Plataforma'}\r\n             </Button>\r\n+</div>\r\n+            \r\n           </div>\r\n         </div>\r\n       </DialogContent>\r\n     </Dialog>\r\n"
                },
                {
                    "date": 1746910004586,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -153,30 +153,47 @@\n           {/* Bot√µes */}\r\n           <div className=\"flex justify-between gap-2 pt-2\">\r\n             {plataformaAtual && (\r\n   <div className=\"flex justify-start\">\r\n+    <AlertDialog>\r\n+  <AlertDialogTrigger asChild>\r\n     <Button\r\n       variant=\"default\"\r\n-      style={{backgroundColor:\"#870D0E\"}}\r\n+      style={{ backgroundColor: '#870D0E' }}\r\n       className=\"flex gap-1 items-center\"\r\n-      onClick={async () => {\r\n-        const confirmar = confirm('Tem certeza que deseja excluir esta plataforma?');\r\n-        if (!confirmar) return;\r\n-\r\n-        const response = await fetch(`/api/plataformas/${plataformaAtual.id}`, {\r\n-          method: 'DELETE',\r\n-        });\r\n-\r\n-        if (response.ok) {\r\n-          alert('Plataforma exclu√≠da com sucesso.');\r\n-          onClose();\r\n-        } else {\r\n-          alert('Erro ao excluir plataforma.');\r\n-        }\r\n-      }}\r\n     >\r\n       <Trash2 className=\"h-4 w-4\" />\r\n     </Button>\r\n+  </AlertDialogTrigger>\r\n+  <AlertDialogContent>\r\n+    <AlertDialogHeader>\r\n+      <AlertDialogTitle>Deseja realmente excluir esta plataforma?</AlertDialogTitle>\r\n+      <AlertDialogDescription>\r\n+        Essa a√ß√£o n√£o pode ser desfeita. A plataforma ser√° permanentemente removida do sistema.\r\n+      </AlertDialogDescription>\r\n+    </AlertDialogHeader>\r\n+    <AlertDialogFooter>\r\n+      <AlertDialogCancel>Cancelar</AlertDialogCancel>\r\n+      <AlertDialogAction\r\n+        className=\"bg-destructive hover:bg-destructive/90\"\r\n+        onClick={async () => {\r\n+          const response = await fetch(`/api/plataformas/${plataformaAtual?.id}`, {\r\n+            method: 'DELETE',\r\n+          });\r\n+\r\n+          if (response.ok) {\r\n+            alert('Plataforma exclu√≠da com sucesso.');\r\n+            onClose();\r\n+          } else {\r\n+            alert('Erro ao excluir plataforma.');\r\n+          }\r\n+        }}\r\n+      >\r\n+        Confirmar\r\n+      </AlertDialogAction>\r\n+    </AlertDialogFooter>\r\n+  </AlertDialogContent>\r\n+</AlertDialog>\r\n   </div>\r\n )}\r\n <div className='flex justify-end gap-2'>\r\n   <Button variant=\"ghost\" onClick={onClose}>\r\n"
                },
                {
                    "date": 1746910013667,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,8 +11,19 @@\n import { Input } from '@/components/ui/input';\r\n import { Label } from '@/components/ui/label';\r\n import { Pencil, Trash2 } from 'lucide-react';\r\n import Image from 'next/image';\r\n+import {\r\n+  AlertDialog,\r\n+  AlertDialogTrigger,\r\n+  AlertDialogContent,\r\n+  AlertDialogHeader,\r\n+  AlertDialogTitle,\r\n+  AlertDialogDescription,\r\n+  AlertDialogFooter,\r\n+  AlertDialogCancel,\r\n+  AlertDialogAction,\r\n+} from '@/components/ui/alert-dialog';\r\n \r\n interface PlataformaModalProps {\r\n   open: boolean;\r\n   onClose: () => void;\r\n"
                },
                {
                    "date": 1746910137500,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -26,14 +26,10 @@\n \r\n interface PlataformaModalProps {\r\n   open: boolean;\r\n   onClose: () => void;\r\n-  onSave: (data: {\r\n-    id?: string;\r\n-    nome: string;\r\n-    imagem?: string;\r\n-    cor: string;\r\n-  }) => void;\r\n+  onSave: (data: { id?: string; nome: string; imagem?: string; cor: string }) => void;\r\n+  onDelete?: () => void; // üëà nova prop opcional\r\n   plataformaAtual?: {\r\n     id: string;\r\n     nome: string;\r\n     imagem?: string;\r\n"
                },
                {
                    "date": 1746910311678,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -47,8 +47,9 @@\n   const [cor, setCor] = useState('#000000'); // cor padr√£o: preto\r\n   const [imagemPreview, setImagemPreview] = useState<string | undefined>(undefined);\r\n   const fileInputRef = useRef<HTMLInputElement>(null);\r\n \r\n+\r\n   useEffect(() => {\r\n     if (open && plataformaAtual) {\r\n       setNome(plataformaAtual.nome);\r\n       setImagemPreview(plataformaAtual.imagem);\r\n@@ -187,13 +188,14 @@\n             method: 'DELETE',\r\n           });\r\n \r\n           if (response.ok) {\r\n-            alert('Plataforma exclu√≠da com sucesso.');\r\n-            onClose();\r\n-          } else {\r\n-            alert('Erro ao excluir plataforma.');\r\n-          }\r\n+  alert('Plataforma exclu√≠da com sucesso.');\r\n+  if (onDelete) onDelete(); // üëà atualiza a lista no front\r\n+  onClose();\r\n+} else {\r\n+  alert('Erro ao excluir plataforma.');\r\n+}\r\n         }}\r\n       >\r\n         Confirmar\r\n       </AlertDialogAction>\r\n"
                },
                {
                    "date": 1746910360648,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -40,8 +40,9 @@\n export default function PlataformaModal({\r\n   open,\r\n   onClose,\r\n   onSave,\r\n+  onDelete,\r\n   plataformaAtual,\r\n }: PlataformaModalProps) {\r\n   const [nome, setNome] = useState('');\r\n   const [cor, setCor] = useState('#000000'); // cor padr√£o: preto\r\n"
                },
                {
                    "date": 1746910400882,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -189,9 +189,8 @@\n             method: 'DELETE',\r\n           });\r\n \r\n           if (response.ok) {\r\n-  alert('Plataforma exclu√≠da com sucesso.');\r\n   if (onDelete) onDelete(); // üëà atualiza a lista no front\r\n   onClose();\r\n } else {\r\n   alert('Erro ao excluir plataforma.');\r\n"
                }
            ],
            "date": 1746909703122,
            "name": "Commit-0",
            "content": "'use client';\r\n\r\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\r\nimport {\r\n  Dialog,\r\n  DialogContent,\r\n  DialogHeader,\r\n  DialogTitle,\r\n} from '@/components/ui/dialog';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Pencil } from 'lucide-react';\r\nimport Image from 'next/image';\r\n\r\ninterface PlataformaModalProps {\r\n  open: boolean;\r\n  onClose: () => void;\r\n  onSave: (data: {\r\n    id?: string;\r\n    nome: string;\r\n    imagem?: string;\r\n    cor: string;\r\n  }) => void;\r\n  plataformaAtual?: {\r\n    id: string;\r\n    nome: string;\r\n    imagem?: string;\r\n    cor: string;\r\n  } | null;\r\n}\r\n\r\nexport default function PlataformaModal({\r\n  open,\r\n  onClose,\r\n  onSave,\r\n  plataformaAtual,\r\n}: PlataformaModalProps) {\r\n  const [nome, setNome] = useState('');\r\n  const [cor, setCor] = useState('#000000'); // cor padr√£o: preto\r\n  const [imagemPreview, setImagemPreview] = useState<string | undefined>(undefined);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  useEffect(() => {\r\n    if (open && plataformaAtual) {\r\n      setNome(plataformaAtual.nome);\r\n      setImagemPreview(plataformaAtual.imagem);\r\n      setCor(plataformaAtual.cor || '#000000');\r\n    } else if (open) {\r\n      setNome('');\r\n      setImagemPreview(undefined);\r\n      setCor('#000000');\r\n    }\r\n  }, [open, plataformaAtual]);\r\n\r\n  const handleFotoChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files?.[0];\r\n    if (file) {\r\n      // 1. Verificar o tipo da imagem\r\n      const tiposPermitidos = ['image/png', 'image/jpeg', 'image/jpg'];\r\n      if (!tiposPermitidos.includes(file.type)) {\r\n        alert('Formato inv√°lido. Apenas PNG, JPG ou JPEG s√£o permitidos.');\r\n        return;\r\n      }\r\n  \r\n      // 2. Verificar o tamanho da imagem\r\n      const tamanhoMaximo = 6 * 1024 * 1024; // 6MB\r\n      if (file.size > tamanhoMaximo) {\r\n        alert('Imagem muito grande. O tamanho m√°ximo permitido √© 6MB.');\r\n        return;\r\n      }\r\n  \r\n      // 3. Se passou nas valida√ß√µes, carregar a imagem\r\n      const reader = new FileReader();\r\n      reader.onloadend = () => setImagemPreview(reader.result as string);\r\n      reader.readAsDataURL(file);\r\n    }\r\n  };\r\n  \r\n\r\n  const handleOpenChange = useCallback((isOpen: boolean) => {\r\n    if (!isOpen) onClose();\r\n  }, [onClose]);\r\n\r\n  const handleSubmit = () => {\r\n    if (!nome.trim()) return;\r\n\r\n    onSave({\r\n      id: plataformaAtual?.id,\r\n      nome,\r\n      imagem: imagemPreview,\r\n      cor,\r\n    });\r\n\r\n    onClose();\r\n  };\r\n\r\n  if (!open) return null;\r\n\r\n  return (\r\n    <Dialog open={open} onOpenChange={handleOpenChange}>\r\n      <DialogContent className=\"max-w-md w-full\">\r\n        <DialogHeader>\r\n          <DialogTitle>{plataformaAtual ? 'Editar Plataforma' : 'Nova Plataforma'}</DialogTitle>\r\n        </DialogHeader>\r\n\r\n        <div className=\"space-y-6\">\r\n          {/* Imagem grande no topo */}\r\n          <div className=\"relative w-full h-[160px] rounded-md overflow-hidden border\">\r\n            {imagemPreview ? (\r\n              <Image src={imagemPreview} alt=\"Imagem Plataforma\" fill className=\"object-cover\" />\r\n            ) : (\r\n              <div className=\"w-full h-full bg-muted flex items-center justify-center text-gray-500 text-sm\">\r\n                Sem imagem\r\n              </div>\r\n            )}\r\n            <div\r\n              className=\"absolute inset-0 bg-black/40 opacity-0 hover:opacity-100 flex items-center justify-center cursor-pointer transition\"\r\n              onClick={() => fileInputRef.current?.click()}\r\n            >\r\n              <Pencil className=\"w-6 h-6 text-white\" />\r\n            </div>\r\n            <input\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              className=\"hidden\"\r\n              ref={fileInputRef}\r\n              onChange={handleFotoChange}\r\n            />\r\n          </div>\r\n\r\n          {/* Nome da plataforma e Cor */}\r\n          <div className=\"flex gap-4\">\r\n  <div className=\"flex-1 space-y-2\" style={{ flexBasis: '65%' }}>\r\n    <Label>Nome da Plataforma</Label>\r\n    <Input\r\n      value={nome}\r\n      onChange={(e) => setNome(e.target.value)}\r\n      placeholder=\"Digite o nome da plataforma\"\r\n    />\r\n  </div>\r\n\r\n  <div className=\"flex-shrink-0 space-y-2\" style={{ flexBasis: '25%' }}>\r\n    <Label>Cor</Label>\r\n    <Input\r\n      type=\"color\"\r\n      value={cor}\r\n      onChange={(e) => setCor(e.target.value)}\r\n      className=\"h-10 p-1\"\r\n    />\r\n  </div>\r\n</div>\r\n          {/* Bot√µes */}\r\n          <div className=\"flex justify-end gap-2 pt-2\">\r\n            {plataformaAtual && (\r\n  <div className=\"flex justify-start\">\r\n    <Button\r\n      variant=\"destructive\"\r\n      className=\"flex gap-1 items-center\"\r\n      onClick={async () => {\r\n        const confirmar = confirm('Tem certeza que deseja excluir esta plataforma?');\r\n        if (!confirmar) return;\r\n\r\n        const response = await fetch(`/api/plataformas/${plataformaAtual.id}`, {\r\n          method: 'DELETE',\r\n        });\r\n\r\n        if (response.ok) {\r\n          alert('Plataforma exclu√≠da com sucesso.');\r\n          onClose();\r\n        } else {\r\n          alert('Erro ao excluir plataforma.');\r\n        }\r\n      }}\r\n    >\r\n      üóëÔ∏è\r\n    </Button>\r\n  </div>\r\n)}\r\n            <Button variant=\"ghost\" onClick={onClose}>\r\n              Cancelar\r\n            </Button>\r\n            <Button onClick={handleSubmit}>\r\n              {plataformaAtual ? 'Salvar Altera√ß√µes' : 'Cadastrar Plataforma'}\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </DialogContent>\r\n    </Dialog>\r\n  );\r\n}\r\n"
        }
    ]
}